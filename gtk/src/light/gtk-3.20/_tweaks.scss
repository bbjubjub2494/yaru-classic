@import 'ubuntu-colors';

$small_radius: 4px;
$_dark_border_color: rgb(20, 19, 19);;

@mixin draw_circle($c, $size:24px) {
  $button_size: $size + 2px * 2;
  $circle_size: 20px / $button_size / 2;

  background-image: -gtk-gradient(radial,
                                  center center, 0,
                                  center center, $circle_size,
                                  to($c),
                                  to(transparent));

  &:hover {
    $_bg: if($c!=$selected_bg_color, transparentize($c, if($variant==light, 0.8, 0.6)), lighten($c, 3%));
    background-image: -gtk-gradient(radial,
                                    center center, 0,
                                    center center, $circle_size,
                                    to($_bg),
                                    to(transparent));

    &:backdrop {
      $_bg: transparentize(white, 0.9);
      background-image: -gtk-gradient(radial,
                                      center center, 0,
                                      center center, $circle_size,
                                      to($_bg),
                                      to(transparent));
    }
  }

  &:active {
    $_bg: if($c!=$selected_bg_color, transparentize($c, if($variant==light, 0.6, 0.4)), darken($c, 2%));
    background-image: -gtk-gradient(radial,
                                    center center, 0,
                                    center center, $circle_size,
                                    to($_bg),
                                    to(transparent));
  }
}

// with a flatter headerbar and buttons, we dont need that heavy shadows in the headerbar
headerbar * {
  text-shadow: none;
  -gtk-icon-shadow: none;
}
// same for the rest of the theme, but not axe the icon shadows, otherwise things don't work
* {
  text-shadow: none;
}

// blue spinner
spinner {
  &:not(:backdrop) {
    color: $progress_bg_color;
  }
}

// TODO: REMOVE the diff when we fixed this upstream (upstream has blue suggested border color)
switch {
  row:selected:not(:disabled) & {
    @if $variant == 'light' {
      box-shadow: none;
      border-color: $selected_borders_color;

      &:backdrop { border-color: $selected_borders_color; }

      slider { &:checked { border-color: $suggested_border_color; } }
    }
  }
}

// titlebutton
button.titlebutton.maximize,  button.titlebutton.minimize, button.titlebutton.close {

  &,
  &:hover,
  &:active {

    headerbar &,
    .titlebar &,
    headerbar.selection-mode & {

      // spec bump otherwise :backdrop  will still have a bg
      &,
      &:backdrop {
        @extend %undecorated_button;
      }
    }
  }

  border-radius: $small_radius;
  min-height: 24px;
  min-width: 24px;
  padding: 2px;

  &.maximize {

    &:hover {
      @include draw_circle($purple);
    }

    &:active {
      @include draw_circle($purple);
    }
  }

  &.minimize {

    &:hover {
      @include draw_circle($purple);
    }

    &:active {
      @include draw_circle($purple);
    }
  }

  &.close {
    color: $headerbar_fg_color;
    @include draw_circle($selected_bg_color);

    &:hover {
      @include draw_circle($selected_bg_color);
    }

    &:active {
      @include draw_circle($selected_bg_color);
    }

    &:backdrop {
      color: $backdrop_fg_color;
    }
  }
}

// make checks and radios more flat, remove this when upstream flattens their cheks/radios
check,
radio {

  &,
  &:hover,
  &:active,
  &:checked,
  &:disabled {

    &:not(.selected) {
      box-shadow: none;
      background-image: none;
      -gtk-icon-shadow: none;
    }
  }


  &:not(:backdrop):checked:not(.selected) {
    border-color: $checkradio_bg_color;
    background-image: image($checkradio_bg_color);
    color: $checkradio_fg_color;
  }

  &:not(:backdrop):disabled:checked {
    background-image: image(mix($checkradio_bg_color, $insensitive_bg_color, 50%));
    border-color: mix($checkradio_bg_color, $insensitive_bg_color, 50%);
  }
}